package com.example.controller;

import com.example.security.MLEService;
import com.example.util.ResourceReader;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api")
public class SecureController {

    private final MLEService mleService;

    public SecureController(MLEService mleService) {
        this.mleService = mleService;
    }

    @GetMapping("/secure")
    public String getSecurePayload() throws Exception {

        // Read JSON from resources
        String payload = ResourceReader.readFile("payload.json");

        // Encrypt using MLE
        return mleService.encrypt(payload);
    }
}