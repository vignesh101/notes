package com.client.controller;

import com.client.security.MLEDecryptService;
import org.springframework.beans.factory.annotation.*;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.client.RestTemplate;

@RestController
@RequestMapping("/client")
public class ClientController {

    @Autowired
    private RestTemplate restTemplate;

    @Autowired
    private MLEDecryptService decryptService;

    @Value("${server.url}")
    private String serverUrl;

    @GetMapping("/call")
    public String callServer() throws Exception {

        // Call server
        String encryptedResponse = restTemplate.getForObject(serverUrl, String.class);

        // Decrypt JWE payload
        String decrypted = decryptService.decrypt(encryptedResponse);

        return decrypted;
    }
}